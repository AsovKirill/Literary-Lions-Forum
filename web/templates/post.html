{{define "heart"}}
<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="15px" height="15px" viewBox="0 0 1280.000000 1189.000000" preserveAspectRatio="xMidYMid meet">
                

    <g transform="translate(0.000000,1189.000000) scale(0.100000,-0.100000)" fill="#A7A7A7" stroke="none">
    <path d="M3250 11884 c-25 -2 -106 -11 -180 -20 -1485 -172 -2704 -1295 -3001 -2764 -133 -660 -67 -1507 171 -2223 252 -753 675 -1411 1397 -2172 342 -360 634 -630 1588 -1470 231 -203 488 -430 570 -505 1024 -920 1735 -1692 2346 -2547 l130 -183 132 0 132 1 130 192 c557 822 1212 1560 2185 2461 191 178 408 373 1027 923 956 852 1445 1343 1841 1850 643 825 968 1603 1064 2553 19 196 17 665 -5 835 -105 805 -441 1497 -998 2054 -557 557 -1250 894 -2054 998 -193 24 -613 24 -810 0 -733 -93 -1379 -387 -1920 -874 -191 -172 -406 -417 -535 -610 -30 -45 -57 -82 -60 -82 -3 0 -30 37 -60 82 -129 193 -344 438 -535 610 -531 478 -1170 773 -1878 867 -146 20 -562 34 -677 24z"/>
    </g>
    </svg>
{{end}}

{{define "post.html"}}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{.Post.Title}} – Lions Literaly</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link rel="stylesheet" href="/static/post.css" />
  </head>
  <body>
    <!-- Top Navigation Bar -->
   
  <header class="navbar">
    <div class="navbar__logo"><a href="/"><img src="/static/logo.png" alt=""></a></div>
    <nav class="navbar__nav">
      <a class="navbar__link" href="/">Forum</a>
      <a class="navbar__link" href="/about">About</a>
      <a class="navbar__link" href="/terms">Terms</a>
    </nav>
    <form class="navbar__search" method="GET" action="/search">
  <input class="search-input" type="text" name="q" placeholder="Type here to search...">
  <button class="search-button" type="submit">
   <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none">

<circle cx="10" cy="9" r="8" stroke="#A7A7A7" stroke-width="2"/>
<path d="M15.5 15.5L19.5 19.5" stroke="#A7A7A7" stroke-width="2" stroke-linecap="round"/></svg>
  </button>
</form>
    <div class="navbar__auth">
  {{if .LoggedIn}}
    <div class="btn btn--secondary"><a href="/logout" class="signup_link">Log Out</a></div>
    <div class="btn btn--primary"><a href="/createpost" class="login_link">Create</a></div>
    <div class="btn btn--create"><a href="/profile" class="profile_link">{{.Username}}</a></div>
  {{else}}
    <div class="btn btn--secondary"><a href="/signup" class="signup_link">Sign up</a></div>
    <div class="btn btn--primary"><a href="/login" class="login_link">Login</a></div>
  {{end}}
</div>
  </header>
  </div>

    <main class="main">
        {{ $loggedIn := .LoggedIn }}
      <!-- Sidebar -->
    <aside class="sidebar">
    <section class="sidebar__section sidebar__categories">
      <h2 class="sidebar__title">Categories</h2>
      <ul class="categories-list">
        {{range .Categories}}
          <li class="categories-list__item"><a href="/category/{{.ID}}">{{.Name}}</a></li>
        {{else}}
          <li class="categories-list__item">No categories</li>
        {{end}}
      </ul>
    </section>
    
  </aside>
      <!-- ─────────────────── Post content ─────────────────── -->
       <section class="posts-feed">
      <section class="content">
          {{/* dummy to inherit card padding */}}
          <article class="post-card post-card--full">
            <div class="post-card__header">
              <span class="post-card__author">{{.Post.Author}}</span>
              <span class="post-card__date"
                >{{.Post.CreatedAt.Format "02 Jan 2006 15:04"}}</span
              >
            </div>

            <h1 class="post-card__title">{{.Post.Title}}</h1>

            <div class="post-card__body">
              {{if .Post.Image}}
              <div class="post-card__image">
                <img
                  src="{{.Post.Image}}"
                  alt=""
                  class="post-card__image-content"
                />
              </div>
              {{end}}
              <p class="post-card__text post_page_texts">{{.Post.Content}}</p>
            </div>

            <div class="post-card__actions">
                <form method="POST" action="/like" style="display:inline;">
                    <input type="hidden" name="post_id" value="{{.Post.ID}}">
                    <input type="hidden" name="return_to" value="/post/{{.Post.ID}}">
                    {{ if $loggedIn }}
                    {{if eq .Post.UserLikeValue 1}}
                    <!-- Already liked: Unlike button -->
                    <input type="hidden" name="value" value="0">
                    <button class="btn-action btn-like" type="submit" title="Unlike">
                      <span class="icon icon--like"><svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="15px" height="15px" viewBox="0 0 1280.000000 1189.000000" preserveAspectRatio="xMidYMid meet">
                        <metadata>
                        Created by potrace 1.15, written by Peter Selinger 2001-2017
                        </metadata>
                        <g transform="translate(0.000000,1189.000000) scale(0.100000,-0.100000)" fill="#A7A7A7" stroke="none">
                        <path d="M3250 11884 c-25 -2 -106 -11 -180 -20 -1485 -172 -2704 -1295 -3001 -2764 -133 -660 -67 -1507 171 -2223 252 -753 675 -1411 1397 -2172 342 -360 634 -630 1588 -1470 231 -203 488 -430 570 -505 1024 -920 1735 -1692 2346 -2547 l130 -183 132 0 132 1 130 192 c557 822 1212 1560 2185 2461 191 178 408 373 1027 923 956 852 1445 1343 1841 1850 643 825 968 1603 1064 2553 19 196 17 665 -5 835 -105 805 -441 1497 -998 2054 -557 557 -1250 894 -2054 998 -193 24 -613 24 -810 0 -733 -93 -1379 -387 -1920 -874 -191 -172 -406 -417 -535 -610 -30 -45 -57 -82 -60 -82 -3 0 -30 37 -60 82 -129 193 -344 438 -535 610 -531 478 -1170 773 -1878 867 -146 20 -562 34 -677 24z"/>
                        </g>
                        </svg></span>
                        <span class="btn-action__count">{{.Post.Likes}}</span>
          </button>
        {{else}}
        <!-- Not liked: Like button -->
        <input type="hidden" name="value" value="1">
        <button class="btn-action btn-like" type="submit" title="Like">
                <span class="icon icon--like"><svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="15px" height="15px" viewBox="0 0 1280.000000 1189.000000" preserveAspectRatio="xMidYMid meet">
    <metadata>
    Created by potrace 1.15, written by Peter Selinger 2001-2017
    </metadata>
    <g transform="translate(0.000000,1189.000000) scale(0.100000,-0.100000)" fill="#A7A7A7" stroke="none">
    <path d="M3250 11884 c-25 -2 -106 -11 -180 -20 -1485 -172 -2704 -1295 -3001 -2764 -133 -660 -67 -1507 171 -2223 252 -753 675 -1411 1397 -2172 342 -360 634 -630 1588 -1470 231 -203 488 -430 570 -505 1024 -920 1735 -1692 2346 -2547 l130 -183 132 0 132 1 130 192 c557 822 1212 1560 2185 2461 191 178 408 373 1027 923 956 852 1445 1343 1841 1850 643 825 968 1603 1064 2553 19 196 17 665 -5 835 -105 805 -441 1497 -998 2054 -557 557 -1250 894 -2054 998 -193 24 -613 24 -810 0 -733 -93 -1379 -387 -1920 -874 -191 -172 -406 -417 -535 -610 -30 -45 -57 -82 -60 -82 -3 0 -30 37 -60 82 -129 193 -344 438 -535 610 -531 478 -1170 773 -1878 867 -146 20 -562 34 -677 24z"/>
    </g>
    </svg></span>
                <span class="btn-action__count">{{.Post.Likes}}</span>
            
            </button>
            {{end}}
            {{else}}
            <!-- Not logged in: Like button, but disabled or login prompt -->
            <a href="/login" class="btn-action btn-like" role="button" tabindex="0">
              <span class="icon icon--like"><svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="15px" height="15px" viewBox="0 0 1280.000000 1189.000000" preserveAspectRatio="xMidYMid meet">
                <metadata>
                Created by potrace 1.15, written by Peter Selinger 2001-2017
                </metadata>
                <g transform="translate(0.000000,1189.000000) scale(0.100000,-0.100000)" fill="#A7A7A7" stroke="none">
                <path d="M3250 11884 c-25 -2 -106 -11 -180 -20 -1485 -172 -2704 -1295 -3001 -2764 -133 -660 -67 -1507 171 -2223 252 -753 675 -1411 1397 -2172 342 -360 634 -630 1588 -1470 231 -203 488 -430 570 -505 1024 -920 1735 -1692 2346 -2547 l130 -183 132 0 132 1 130 192 c557 822 1212 1560 2185 2461 191 178 408 373 1027 923 956 852 1445 1343 1841 1850 643 825 968 1603 1064 2553 19 196 17 665 -5 835 -105 805 -441 1497 -998 2054 -557 557 -1250 894 -2054 998 -193 24 -613 24 -810 0 -733 -93 -1379 -387 -1920 -874 -191 -172 -406 -417 -535 -610 -30 -45 -57 -82 -60 -82 -3 0 -30 37 -60 82 -129 193 -344 438 -535 610 -531 478 -1170 773 -1878 867 -146 20 -562 34 -677 24z"/>
                </g>
                </svg></span>
              <span class="btn-action__count">{{.Post.Likes}}</span></a>
      {{end}}
            </form>
              <button class="btn-action btn-comment" type="button" disabled>
                <span class="icon icon--comment"><svg xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 12 12" fill="none">
                    <circle cx="7.28582" cy="4.71428" r="4.71428" fill="#BABABA"/>
                    <path d="M1.4039 9.28886L4.73295 4.58606L7.16468 9.17807L1.4039 9.28886Z" fill="#BABABA"/>
                    </svg></span>
                <span class="btn-action__count">{{len .Comments}}</span>
              </button>
               {{if and .LoggedIn (eq .Post.UserID .CurrentUserID)}}
          <form method="POST" action="/deletepost" style="display:inline;" onsubmit="return confirm('Delete this post?');">
            <input type="hidden" name="post_id" value="{{.Post.ID}}">
            <button class="btn btn-action btn--danger btn--delete" type="submit">Delete</button>
          </form>
          {{end}}
            </div>
          </article>
          <!-- ──────────────── post delete ──────────────── -->
         

        <!-- ──────────────── Comment box ──────────────── -->
        <section class="comments">
          <h2 class="comments__title">Comments</h2>

          {{if .LoggedIn}}
          <form method="POST" class="comment-form">
            <textarea
              name="comment"
              rows="3"
              placeholder="Write your comment…"
              class="comment-form__textarea"
            ></textarea>
            <button class="btn btn--primary btn--comment" type="submit">Send</button>
          </form>
          {{else}}
          <p class="comments__login-hint">
            <a href="/login">Log in</a> to leave a comment.
          </p>
          {{end}}

          <!-- existing comments -->
           
          {{/* ─────────────── existing comments — */}}
          <div class="comments-list">
          {{range .Comments}}
          <article class="comment">
            <div class="comment__header">
              <span class="comment__author">{{.Author}}</span>
              <span class="comment__date">{{.CreatedAt.Format "02 Jan 2006 15:04"}}</span>
            </div>
          
            <p class="comment__text">{{.Content}}</p>
          
            <div class="comment__actions">
                {{/* like / unlike button */}}
                <form method="POST" action="/comment-like" style="display:inline;">
                  <input type="hidden" name="comment_id" value="{{.ID}}">
                  {{if $.LoggedIn}}
                    {{if eq .UserLikeValue 1}}
                      <input type="hidden" name="value" value="0">
                      <button class="btn-action btn-like">{{template "heart"}}
                        <span class="btn-action__count">{{.Likes}}</span>
                      </button>
                    {{else}}
                      <input type="hidden" name="value" value="1">
                      <button class="btn-action btn-like">{{template "heart"}}
                        <span class="btn-action__count">{{.Likes}}</span>
                      </button>
                    {{end}}
                  {{else}}
                    <a href="/login" class="btn-action btn-like">{{template "heart"}}
                      <span class="btn-action__count">{{.Likes}}</span>
                    </a>
                  {{end}}
                </form>
                <!-- PLACE DELETE BUTTON HERE: -->
    {{if and $.LoggedIn (eq .UserID $.CurrentUserID)}}
    <form method="POST" action="/deletecomment" style="display:inline;" onsubmit="return confirm('Delete this comment?');">
      <input type="hidden" name="comment_id" value="{{.ID}}">
      <button class="btn btn--danger" type="submit">Delete</button>
    </form>
  {{end}}
</div>
              </article>
              {{end}}
              </div>
        </section>
      </section>
      </section>
    </main>
  </body>
</html>
{{end}}
